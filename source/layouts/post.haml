!!! html5
%html{:lang => "ja", :prefix => "og: http://ogp.me/ns#"}
  %head
    %meta{:charset => "utf-8"}
    %meta{:content => "width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0", :name => "viewport"}
    %meta{:content => "#{current_article.title} | #{data.site.name}", :property => "og:title"}
    %meta{:content => "article", :property => "og:type"}
    %meta{:content => "#{data.site.url}#{current_article.url}", :property => "og:url"}
    %meta{:content => "#{data.site.url}/images/logo.png", :property => "og:image"}
    %meta{:content => "#{data.site.url}/images/logo.png", :property => "og:image:secure_url"}
    %link{:rel => "shortcut icon", :href => "/favicon.ico", :type => "image/vnd.microsoft.icon" }
    %link{:rel => "icon", :href => "/favicon.ico", :type => "image/vnd.microsoft.icon" }
    %link{:rel => "alternate", :title => data.site.name, :href => "/feed.xml", :type => "application/atom+xml"}
    %link{:rel => "canonical", :href => "#{data.site.url}#{current_article.url}"}
    %link{:rel => "license", :href => "//creativecommons.org/licenses/by-nc/3.0/deed.ja"}
    %link{:rel => "author", :href => "/about.html"}
    - previous_article = current_article.article_previous
    - next_article = current_article.article_next
    - if previous_article
      %link{:rel => "prev", :href => previous_article.url}
    - if next_article
      %link{:rel => "next", :href => next_article.url}
    %title
      #{current_article.title unless current_article.nil?} | #{data.site.name}
    = stylesheet_link_tag "normalize.css", "font-awesome/css/font-awesome.min.css", "all"
    <script src="//codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="//b.st-hatena.com/js/bookmark_button.js" async="async"></script>
    = javascript_include_tag "jquery-2.0.3.min.js"
    = javascript_include_tag "application"
    - if build?
      :javascript
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-45923728-1', 'dakatsuka.jp');
        ga('send', 'pageview');

  %body.page
    = partial "layouts/header"

    %main(role="main")
      %article.entry(itemscope itemtype="//schema.org/BlogPosting" itemref="author")
        %header
          %h1(itemprop="name")= current_article.title
          %link{:href => current_article.url, :itemprop => "url"}

        %div.body
          %aside.metadata
            %ul
              %li.published
                %time{:datetime => current_article.date.iso8601, :itemprop => "datePublished"}= current_article.date.strftime("%Y年%m月%d日")
              %li.tags(itemprop="keywords")= current_article.tags.map {|tag| link_to tag, tag_path(tag) }.join(", ")

          .entry-content(itemprop="articleBody")
            = yield
          = partial "layouts/ads"

          %aside.share
            %ul
              %li.twitter
                - encoded_text = URI.escape("#{current_article.title} | dakatsuka's blog")
                %a{:href => "//twitter.com/share?url=#{data.site.url}#{current_article.url}&via=d_akatsuka&text=#{encoded_text}"} Twitterでシェアする
              %li.facebook
                %a{:href => "//www.facebook.com/share.php?u=#{data.site.url}#{current_article.url}"} Facebookでシェアする
              %li.hatebu
                %a{:href => "//b.hatena.ne.jp/entry/#{data.site.url}#{current_article.url}",
                  "class" => "hatena-bookmark-button",
                  "data-hatena-bookmark-title"  => "#{current_article.title} | dakatsuka's blog",
                  "data-hatena-bookmark-layout" => "simple",
                  "title" => "このエントリーをはてなブックマークに追加"} はてブする

        :javascript
          $(".share .facebook a").on('click', function(e) {
            e.preventDefault();
            window.open(this.href, 'FBwindow', 'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes');
          });

          $(".share .twitter a").on('click', function(e) {
            e.preventDefault();
            window.open(this.href, 'TWwindow', 'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes');
          });

      %aside
        %nav.entry-navigation(role="navigation")
          %ul
            %li.prev
              - if previous_article
                %a{:href => previous_article.url, :title => previous_article.title} Prev
              - else
                %span.disable Prev
            %li.next
              - if next_article
                %a{:href => next_article.url, :title => next_article.title} Next
              - else
                %span.disable Next

        %section.author#author(itemprop="author" itemscope itemtype="http://schema.org/Person")
          %p.avatar
            %img{:src => image_path("avatar.jpeg"), :width => 80, :height => 80, :alt => "avatar"}

          %dl
            %dt Written by
            %dd.name(itemprop="name") Dai Akatsuka
            %dd.description 東京都在住のWebエンジニアです。好きな言語はRuby。仕事ではRuby, Scala成分高めで最近は関数型に興味があります。Goにも手を出したい今日この頃。
            %dd.accounts
              %a{:href => "https://twitter.com/d_akatsuka"}
                %i.fa.fa-twitter-square
              %a{:href => "https://facebook.com/dai.akatsuka"}
                %i.fa.fa-facebook-square
              %a{:href => "https://github.com/dakatsuka"}
                %i.fa.fa-github-square
              %a{:href => "mailto:d.akatsuka@gmail.com"}
                %i.fa.fa-envelope

    = partial "layouts/footer"
