!!! html5
%html{:lang => "ja", :prefix => "og: http://ogp.me/ns#"}
  %head
    %meta{:charset => "utf-8"}
    %meta{:content => "IE=edge;chrome=1", "http-equiv" => "X-UA-Compatible"}
    %meta{:content => "width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0", :name => "viewport"}
    %meta{:content => "#{current_article.title} | dakatsuka's blog", :property => "og:title"}
    %meta{:content => "article", :property => "og:type"}
    %meta{:content => "http://blog.dakatsuka.jp#{current_article.url}", :property => "og:url"}
    %meta{:content => "http://blog.dakatsuka.jp/images/ogp.png", :property => "og:image"}
    %link{:rel => "shortcut icon", :href => "/favicon.ico", :type => "image/vnd.microsoft.icon" }
    %link{:rel => "icon", :href => "/favicon.ico", :type => "image/vnd.microsoft.icon" }
    %link{:rel => "alternate", :title => "dakatsuka's blog", :href => "/feed.xml", :type => "application/atom+xml"}
    %title
      #{current_article.title unless current_article.nil?} | dakatsuka's blog
    = stylesheet_link_tag "http://yui.yahooapis.com/pure/0.3.0/pure-min.css", "font-awesome/css/font-awesome.min.css", "all"
    <script src="http://codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="http://b.st-hatena.com/js/bookmark_button.js" async="async"></script>
    = javascript_include_tag "application"

  %body.page
    = partial "layouts/header"

    %main
      %article.entry
        %header
          %h1= current_article.title

        %div.body
          %aside.metadata
            %ul
              %li.published
                %time{:datetime => current_article.date.iso8601}= current_article.date.strftime("%Y年%m月%d日")
              %li.tags= current_article.tags.map {|tag| link_to tag, tag_path(tag) }.join(", ")

          = yield
          = partial "layouts/ads"

          %aside.share
            %ul
              %li.twitter
                - encoded_text = URI.escape("#{current_article.title} | dakatsuka's blog")
                %a{:href => "http://twitter.com/share?url=http://blog.dakatsuka.jp#{current_article.url}&via=d_akatsuka&text=#{encoded_text}"} Twitterでシェアする
              %li.facebook
                %a{:href => "http://www.facebook.com/share.php?u=http://blog.dakatsuka.jp#{current_article.url}"} Facebookでシェアする
              %li.hatebu
                %a{:href => "http://b.hatena.ne.jp/entry/http://blog.dakatsuka.jp#{current_article.url}",
                  "class" => "hatena-bookmark-button",
                  "data-hatena-bookmark-title"  => "#{current_article.title} | dakatsuka's blog",
                  "data-hatena-bookmark-layout" => "simple",
                  "title" => "このエントリーをはてなブックマークに追加"} はてブする

      %aside
        %nav.entry-navigation
          %ul
            %li.prev
              - previous_article = current_article.previous_article
              - if previous_article
                %a{:href => previous_article.url, :title => previous_article.title} Prev
              - else
                %span.disable Prev
            %li.next
              - next_article = current_article.next_article
              - if next_article
                %a{:href => next_article.url, :title => next_article.title} Next
              - else
                %span.disable Next

        %section.author
          %p.avatar
            %img{:src => image_path("avatar.jpeg"), :width => 80, :height => 80}
            
          %dl
            %dt Written by
            %dd.name Dai Akatsuka
            %dd.description 東京都在住のWebエンジニアです。好きな言語はRubyですが仕事ではPHPばかり触っています。サーバサイドプログラミングからインフラ構築まで手広くやっています。
            %dd.accounts
              %a{:href => "http://twitter.com/d_akatsuka"}
                %i.fa.fa-twitter-square
              %a{:href => "http://facebook.com/dai.akatsuka"}
                %i.fa.fa-facebook-square
              %a{:href => "http://github.com/dakatsuka"}
                %i.fa.fa-github-square
              %a{:href => "mailto:d.akatsuka@gmail.com"}
                %i.fa.fa-envelope

    = partial "layouts/footer"

    :javascript
      $(".share .facebook a").on('click', function(e) {
        e.preventDefault();
        window.open(this.href, 'FBwindow', 'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes');
      });

      $(".share .twitter a").on('click', function(e) {
        e.preventDefault();
        window.open(this.href, 'TWwindow', 'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes');
      });
